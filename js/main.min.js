const canvas=document.querySelector(".canvas"),width=canvas.width=window.innerWidth,height=canvas.height=window.innerHeight,ctx=canvas.getContext("2d");let curX=0,curY=0,pointX=0,pointY=0,pressed=!1,history=[];const colorPicker=document.querySelector(".toolbar__colorpick"),sizePicker=document.querySelector(".toolbar__sizepick"),clearBtn=document.querySelector("#clear"),copyBtn=document.querySelector("#copy");function clear(){ctx.fillStyle="rgb(256,256,256)",ctx.fillRect(0,0,width,height)}function copy(){canvas.toBlob((function(e){const t=new ClipboardItem({"image/png":e});navigator.clipboard.write([t])})),notifySend("Success copy","notify--success",3e3,!0)}function degToRad(e){return e*Math.PI/180}function draw(){pressed||(pointX=curX,pointY=curY),pressed&&(ctx.beginPath(),ctx.moveTo(pointX,pointY),ctx.lineCap="round",ctx.lineWidth=sizePicker.value,ctx.lineTo(curX,curY),ctx.strokeStyle=colorPicker.value,ctx.stroke(),pointX=curX,pointY=curY),requestAnimationFrame(draw)}function notifySend(e,t,n,o){let c=document.querySelector("body"),i=document.createElement("div");i.classList=t+" "+t+"--in",i.innerHTML=e,o&&i.addEventListener("click",(()=>{i.classList=t+" "+t+"--out",setTimeout((()=>{c.removeChild(i)}),100)})),c.append(i),setTimeout((()=>{i.classList.remove(t+"--in")}),100),setTimeout((()=>{i.classList=t+" "+t+"--out"}),n-100??2900),setTimeout((()=>{c.removeChild(i)}),n??3e3)}clearBtn.addEventListener("click",(()=>{clear(),notifySend("Cleared","notify--success",3e3,!0)})),clear(),copyBtn.addEventListener("click",(()=>{copy()})),document.addEventListener("mousemove",(e=>{curX=window.Event?e.pageX:e.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft),curY=window.Event?e.pageY:e.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop)})),document.addEventListener("keydown",(()=>{if(event.ctrlKey&&"z"===event.key){let e=new Image;e.onload=()=>{ctx.drawImage(e,0,0)};let t=history.pop()??null;e.src=t}})),canvas.addEventListener("mousedown",(()=>{pressed=!0,history.push(canvas.toDataURL()),history.length>=100&&history.shift()})),canvas.addEventListener("mouseup",(()=>{pressed=!1})),draw();